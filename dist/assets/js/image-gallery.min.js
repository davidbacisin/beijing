!function(e){function t(e,t){for(var n=e.parentNode;n&&!n.classList.contains(t);)n=n.parentNode;return n}function n(e,t){for(var n=e.previousSibling;n&&(!n.classList||!n.classList.contains(t));)n=n.previousSibling;return n}function a(e){for(var t;t=e.lastChild;)e.removeChild(t)}function i(e){setTimeout(function(){try{var a=t(e,"gallery").id,i=document.getElementById(a+"-fig"),r=i.getElementsByTagName("img")[0];r.src=e.getElementsByTagName("img")[0].src;var l=n(e,"caption"),o=i.getElementsByTagName("figcaption")[0];o.innerHTML=l.innerHTML}catch(e){console.log("An exception occured while setting the gallery image:"),console.log(e)}},0)}e.body.addEventListener("click",function(e){var t=e.target;"image-link"==t.parentNode.className&&(t=t.parentNode),"image-link"==t.className&&i(t)});for(var r=e.getElementsByClassName("image-link"),l=0;l<r.length;l++){var o=r[l],s=new Image;s.src=o.getAttribute("href"),a(o),o.appendChild(s),o.removeAttribute("href"),o.removeAttribute("target")}for(var c=e.getElementsByClassName("gallery"),l=0;l<c.length;l++){var g=c[l];g.classList.add("js");var m=document.createElement("figure");m.className="gallery-fig",m.id=g.id+"-fig";var d=document.createElement("figcaption"),f=new Image;m.appendChild(f),m.appendChild(d),g.parentNode.insertBefore(m,g)}}(document);